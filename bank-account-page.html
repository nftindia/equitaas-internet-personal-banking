<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Account - Equitas Bank</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .text-equitas-purple {
            color: #4D267A;
        }
        .bg-equitas-purple {
            background-color: #4D267A;
        }
        .bg-equitas-purple-lightest {
            background-color: #F4F0F8;
        }
        .hover\:bg-equitas-purple-lighter:hover {
            background-color: #E9E0F0;
        }
    </style>
</head>
<body class="bg-gradient-to-b from-purple-50 to-purple-200">

    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-1">
                    <div class="flex items-center space-x-2">
                        <div class="w-12 h-12 flex flex-col items-center justify-center rounded-lg bg-slate-100 border border-slate-200">
                            <div class="text-xs font-bold text-white bg-equitas-purple w-full text-center rounded-t-md py-0.5" id="date-month">AUG</div>
                            <div id="date-day" class="text-2xl font-bold text-slate-700">03</div>
                        </div>
                        <div>
                            <p id="date-weekday" class="font-semibold text-slate-700">Sunday</p>
                            <p id="time-display" class="text-xs text-slate-500 font-medium">01:25 AM</p>
                        </div>
                    </div>
                </div>
                <div class="flex-1 flex justify-center">
                    <svg class="h-16 w-auto" viewBox="0 0 450 100" xmlns="http://www.w3.org/2000/svg">
                        <g>
                            <circle cx="50" cy="50" r="50" fill="#4D267A"/>
                            <rect x="25" y="30" width="50" height="8" fill="white"/>
                            <rect x="25" y="46" width="35" height="8" fill="white"/>
                            <rect x="25" y="62" width="50" height="8" fill="white"/>
                        </g>
                        <text x="120" y="65" font-family="Inter, sans-serif" font-size="50" font-weight="bold" fill="#4D267A">equitas</text>
                        <text x="120" y="88" font-family="Inter, sans-serif" font-size="18" font-weight="500" fill="#4D267A">Small Finance Bank</text>
                    </svg>
                </div>
                <div class="flex-1 flex justify-end">
                    <div class="flex items-center space-x-2 sm:space-x-4">
                        <span class="hidden sm:block text-sm font-medium text-slate-600">Madhan Kumar</span>
                        <button id="search-button" class="p-2 rounded-full text-slate-500 hover:bg-slate-100 hover:text-slate-700 transition">
                            <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                            </svg>
                        </button>
                        <div class="relative">
                            <button id="notification-button" class="p-2 rounded-full text-slate-500 hover:bg-slate-100 hover:text-slate-700 transition">
                                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" />
                                </svg>
                                <span class="absolute top-1.5 right-1.5 block h-2.5 w-2.5 rounded-full bg-red-500 ring-2 ring-white"></span>
                            </button>
                            <div id="notification-dropdown" class="hidden absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-slate-200 z-50">
                                <div class="p-4 font-semibold border-b">Notifications</div>
                                <ul class="p-2 max-h-80 overflow-y-auto">
                                    <li class="p-2 border-b border-slate-100">
                                        <p class="text-sm text-green-600 font-semibold">Credit: +₹2,91,000.00</p>
                                        <p class="text-xs text-slate-500">Salary credit received.</p>
                                    </li>
                                    <li class="p-2 border-b border-slate-100">
                                        <p class="text-sm text-red-600 font-semibold">Debit: -₹45,000.00</p>
                                        <p class="text-xs text-slate-500">IMPS transfer to Star Enterprises.</p>
                                    </li>
                                    <li class="p-2 border-b border-slate-100">
                                        <p class="text-sm text-red-600 font-semibold">Debit: -₹2,500.00</p>
                                        <p class="text-xs text-slate-500">UPI payment to Shankar.</p>
                                    </li>
                                    <li class="p-2">
                                        <p class="text-sm text-red-600 font-semibold">Debit: -₹550.00</p>
                                        <p class="text-xs text-slate-500">Payment to Zomato.</p>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <a href="#" id="logout-link" class="flex items-center text-sm font-medium text-equitas-purple hover:underline">
                            <svg class="h-5 w-5 mr-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9" />
                            </svg>
                            <span class="hidden sm:inline">Logout</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div id="search-bar-container" class="hidden sticky top-16 z-30 bg-white bg-opacity-90 backdrop-blur-sm shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
            <div class="relative">
                <input type="text" id="search-input" placeholder="Search transactions (e.g., Shankar, Zomato, NEFT)..." class="w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" /></svg>
                </div>
            </div>
        </div>
    </div>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-slate-900">Welcome back, Madhan!</h1>
            <p class="text-slate-500 mt-1">Here's a summary of your account.</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-1 space-y-8">
                <div class="bg-white p-6 rounded-2xl shadow-lg border-t-4 border-purple-800">
                    <h2 class="text-sm font-medium text-slate-500">Available Balance</h2>
                    <p id="balance" class="text-4xl font-bold text-slate-900 mt-2">₹12,34,567.89</p>
                    <div class="mt-4 text-sm text-slate-600">
                        <p>Account: <span class="font-medium">Checking **** 4321</span></p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-lg">
                    <h2 class="text-lg font-semibold text-slate-800 mb-4">Quick Actions</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <a href="fund-transfer.html" class="flex flex-col items-center justify-center p-4 bg-equitas-purple-lightest hover:bg-equitas-purple-lighter rounded-lg transition">
                            <svg class="h-8 w-8 text-equitas-purple mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" /></svg>
                            <span class="text-sm font-medium text-equitas-purple">Transfer</span>
                        </a>
                         <button class="flex flex-col items-center justify-center p-4 bg-equitas-purple-lightest hover:bg-equitas-purple-lighter rounded-lg transition">
                            <a href="pay-bills.html" class="flex flex-col items-center justify-center p-4 bg-equitas-purple-lightest hover:bg-equitas-purple-lighter rounded-lg transition">
							<svg class="h-8 w-8 text-equitas-purple mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15A2.25 2.25 0 002.25 6.75v10.5A2.25 2.25 0 004.5 21.75z" /></svg>
                            <span class="text-sm font-medium text-equitas-purple">Pay Bills</span>
							</a>
                        </button>
                         <button class="flex flex-col items-center justify-center p-4 bg-equitas-purple-lightest hover:bg-equitas-purple-lighter rounded-lg transition">
                            <svg class="h-8 w-8 text-equitas-purple mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>
                            <span class="text-sm font-medium text-equitas-purple">Deposit</span>
                        </button>
                         <button class="flex flex-col items-center justify-center p-4 bg-equitas-purple-lightest hover:bg-equitas-purple-lighter rounded-lg transition">
                            <svg class="h-8 w-8 text-equitas-purple mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>
                            <span class="text-sm font-medium text-equitas-purple">Statements</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold text-slate-800">Recent Transactions</h2>
                    <a href="#" class="text-sm font-medium text-equitas-purple hover:underline">View All</a>
                </div>
                <ul id="transaction-list" class="space-y-2">
                    <!-- Transactions will be populated by script -->
                </ul>
            </div>
        </div>
    </main>
    
    <div id="logout-modal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 text-center">
            <h3 class="text-lg font-semibold text-slate-900">Confirm Logout</h3>
            <p class="text-slate-500 mt-2 mb-6">Are you sure you want to log out?</p>
            <div class="flex justify-center space-x-4">
                <button id="cancel-logout" class="px-6 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition">Cancel</button>
                <button id="confirm-logout" class="px-6 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition">Logout</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const logoutLink = document.getElementById('logout-link');
            const logoutModal = document.getElementById('logout-modal');
            const cancelLogoutBtn = document.getElementById('cancel-logout');
            const confirmLogoutBtn = document.getElementById('confirm-logout');
            const notificationButton = document.getElementById('notification-button');
            const notificationDropdown = document.getElementById('notification-dropdown');
            const searchButton = document.getElementById('search-button');
            const searchBarContainer = document.getElementById('search-bar-container');
            const searchInput = document.getElementById('search-input');
            const transactionList = document.getElementById('transaction-list');
            const balanceEl = document.getElementById('balance');

            // --- Balance and Transaction Update Logic ---
            function updateDashboard() {
                // 1. Update Balance
                const amountToDeduct = parseFloat(localStorage.getItem('transactionAmountToDeduct'));
                let currentBalance;
                const storedBalance = localStorage.getItem('currentBalance');

                if (storedBalance) {
                    currentBalance = parseFloat(storedBalance);
                } else {
                    currentBalance = 1234567.89;
                }

                if (!isNaN(amountToDeduct)) {
                    currentBalance -= amountToDeduct;
                    localStorage.removeItem('transactionAmountToDeduct');
                }

                localStorage.setItem('currentBalance', currentBalance);
                balanceEl.textContent = '₹' + currentBalance.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

                // 2. Manage Transaction History
                let transactions = JSON.parse(localStorage.getItem('transactionHistory')) || [
                    // Default transactions if none exist
                    { name: 'Shankar', details: 'UPI / P2P / T25080222490', amount: -2500.00, date: '2025-08-02T12:00:00.000Z' },
                    { name: 'Star Enterprises', details: 'IMPS / P2A / T25080215301', amount: -45000.00, date: '2025-08-02T11:00:00.000Z' },
                    { name: 'Zomato Order', details: 'Zomato / P2M / T25080211350', amount: -550.00, date: '2025-08-02T10:00:00.000Z' },
                    { name: 'Salary Credit', details: 'NEFT / P2A / T25080109302', amount: 291000.00, date: '2025-08-01T09:00:00.000Z' },
                    { name: 'Future Retail Ltd', details: 'NEFT / P2A / T25073122109', amount: -53000.00, date: '2025-07-31T15:00:00.000Z' },
                ];

                const newTransactionJSON = localStorage.getItem('newTransaction');
                if (newTransactionJSON) {
                    const newTx = JSON.parse(newTransactionJSON);
                    transactions.unshift(newTx); // Add new transaction to the beginning
                    localStorage.removeItem('newTransaction');
                }
                
                // Keep only the latest 10 transactions
                if (transactions.length > 10) {
                    transactions = transactions.slice(0, 10);
                }
                
                localStorage.setItem('transactionHistory', JSON.stringify(transactions));
                renderTransactions(transactions);
            }

            function renderTransactions(transactions) {
                transactionList.innerHTML = ''; // Clear the list before rendering
                transactions.forEach(tx => {
                    const txDate = new Date(tx.date);
                    const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
                    const amountClass = tx.amount > 0 ? 'text-green-600' : 'text-red-600';
                    const amountSign = tx.amount > 0 ? '+' : '';

                    const newTxHTML = `
                        <li class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-50">
                            <div class="flex items-center">
                                <div class="w-11 h-11 flex flex-col items-center justify-center rounded-lg bg-slate-100 border border-slate-200 mr-4 flex-shrink-0">
                                    <div class="text-xs font-bold text-equitas-purple">${months[txDate.getMonth()]}</div>
                                    <div class="text-xl font-bold text-slate-700">${txDate.getDate().toString().padStart(2, '0')}</div>
                                </div>
                                <div>
                                    <p class="font-medium text-slate-800">${tx.name}</p>
                                    <p class="text-xs text-slate-500">${tx.details}</p>
                                </div>
                            </div>
                            <p class="font-bold ${amountClass}">${amountSign}₹${Math.abs(tx.amount).toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                        </li>
                    `;
                    transactionList.insertAdjacentHTML('beforeend', newTxHTML);
                });
            }

            updateDashboard();

            logoutLink.addEventListener('click', function(event) {
                event.preventDefault();
                logoutModal.classList.remove('hidden');
            });

            cancelLogoutBtn.addEventListener('click', function() {
                logoutModal.classList.add('hidden');
            });

            confirmLogoutBtn.addEventListener('click', function() {
                localStorage.clear(); // Clear all data on logout
                window.location.href = 'login.html';
            });

            notificationButton.addEventListener('click', function(event) {
                event.stopPropagation();
                notificationDropdown.classList.toggle('hidden');
            });

            window.addEventListener('click', function(event) {
                if (!notificationButton.contains(event.target) && !notificationDropdown.contains(event.target)) {
                    notificationDropdown.classList.add('hidden');
                }
            });
            
            searchButton.addEventListener('click', function() {
                searchBarContainer.classList.toggle('hidden');
                if (!searchBarContainer.classList.contains('hidden')) {
                    searchInput.focus();
                }
            });

            searchInput.addEventListener('input', function() {
                const filter = searchInput.value.toLowerCase();
                const transactionItems = transactionList.getElementsByTagName('li');
                for (let i = 0; i < transactionItems.length; i++) {
                    const item = transactionItems[i];
                    const text = item.textContent || item.innerText;
                    if (text.toLowerCase().indexOf(filter) > -1) {
                        item.style.display = "";
                    } else {
                        item.style.display = "none";
                    }
                }
            });

            function updateDateTime() {
                const today = new Date();
                const weekdays = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];

                document.getElementById('date-month').textContent = months[today.getMonth()];
                document.getElementById('date-day').textContent = today.getDate().toString().padStart(2, '0');
                document.getElementById('date-weekday').textContent = weekdays[today.getDay()];
                
                const timeOptions = { hour: '2-digit', minute: '2-digit', hour12: true };
                const timeString = today.toLocaleTimeString('en-IN', timeOptions);
                const timeDisplay = document.getElementById('time-display');
                if (timeDisplay) {
                    timeDisplay.textContent = timeString;
                }
            }
            
            updateDateTime();
            setInterval(updateDateTime, 1000);
        });
    </script>

</body>
</html>