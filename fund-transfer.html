<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fund Transfer - Equitas Bank</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .text-equitas-purple {
            color: #4D267A;
        }
        .bg-equitas-purple {
            background-color: #4D267A;
        }
        .border-equitas-purple {
            border-color: #4D267A;
        }
        .focus\:ring-equitas-purple:focus {
            --tw-ring-color: #4D267A;
        }
        /* Spinner for IFSC validation */
        .loader {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #4D267A;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gradient-to-b from-purple-50 to-purple-200">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Left: Date Calendar -->
                <div class="flex-1">
                    <div class="flex items-center space-x-2">
                        <div class="w-12 h-12 flex flex-col items-center justify-center rounded-lg bg-slate-100 border border-slate-200">
                            <div class="text-xs font-bold text-white bg-equitas-purple w-full text-center rounded-t-md py-0.5" id="date-month">AUG</div>
                            <div id="date-day" class="text-2xl font-bold text-slate-700">03</div>
                        </div>
                        <div>
                            <p id="date-weekday" class="font-semibold text-slate-700">Sunday</p>
                        </div>
                    </div>
                </div>

                <!-- Center: Logo -->
                <div class="flex-1 flex justify-center">
                    <svg class="h-16 w-auto" viewBox="0 0 450 100" xmlns="http://www.w3.org/2000/svg">
                        <center>
				<img src="https://i.postimg.cc/rFJSTYwg/download.png"></center>
                    </svg>
                </div>

                <!-- Right: Profile and Home -->
                <div class="flex-1 flex justify-end">
                    <div class="flex items-center space-x-4">
                         <a href="bank-account-page.html" class="p-2 rounded-full text-slate-500 hover:bg-slate-100 hover:text-equitas-purple transition" title="Home">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                            </svg>
                        </a>
                        <span class="text-sm font-medium text-slate-600">Vishagan</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="mb-4">
             <a href="bank-account-page.html" class="inline-flex items-center text-sm font-medium text-slate-600 hover:text-equitas-purple transition">
               <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                Back to Dashboard
            </a>
        </div>
        <h1 class="text-3xl font-bold text-slate-900 mb-6">Fund Transfer</h1>
        
        <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
            <!-- Tabs -->
            <div class="border-b border-slate-200">
                <nav class="-mb-px flex space-x-6 overflow-x-auto" aria-label="Tabs">
                    <button class="tab-button border-equitas-purple text-equitas-purple whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-target="add-beneficiary">Add Beneficiary</button>
                    <button class="tab-button border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-target="manage-beneficiary">Manage Beneficiary</button>
                    <button class="tab-button border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-target="imps-transfer">IMPS Transfer</button>
                    <button class="tab-button border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-target="neft-transfer">NEFT Transfer</button>
                </nav>
            </div>

            <!-- Tab Content -->
            <div class="mt-8">
                <!-- Add Beneficiary Form -->
                <div id="add-beneficiary" class="tab-content">
                    <form id="beneficiary-form" class="space-y-6">
                        <h3 class="text-lg font-semibold text-slate-800">Add New Payee</h3>
                        <div id="success-alert" class="hidden p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg" role="alert">
                            <span class="font-medium">Success!</span> Beneficiary added successfully.
                        </div>
                        <div>
                            <label for="beneficiary-name" class="block text-sm font-medium text-slate-700">Beneficiary Name</label>
                            <input type="text" id="beneficiary-name" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm" placeholder="e.g., Shankar" required>
                        </div>
                        <div>
                            <label for="beneficiary-account" class="block text-sm font-medium text-slate-700">Account Number</label>
                            <input type="text" id="beneficiary-account" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm" placeholder="Enter account number" required>
                        </div>
                        <div>
                            <label for="beneficiary-ifsc" class="block text-sm font-medium text-slate-700">IFSC Code</label>
                            <div class="relative mt-1">
                                <input type="text" id="beneficiary-ifsc" class="block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm pr-10" placeholder="Enter IFSC code" required>
                                <div id="ifsc-loader" class="absolute inset-y-0 right-0 pr-3 flex items-center hidden">
                                    <div class="loader"></div>
                                </div>
                            </div>
                            <p id="ifsc-error" class="mt-2 text-sm text-red-600 hidden">Wrong IFSC Code</p>
                            <p id="ifsc-details" class="mt-2 text-sm text-green-600 font-medium hidden"></p>
                        </div>
                        <div class="text-right">
                            <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-equitas-purple hover:bg-opacity-90">Add Beneficiary</button>
                        </div>
                    </form>
                </div>
                <!-- Manage Beneficiary Form -->
                <div id="manage-beneficiary" class="tab-content hidden">
                    <form id="manage-beneficiary-form" class="space-y-6">
                        <h3 class="text-lg font-semibold text-slate-800">Update or Delete Payee</h3>
                        <div>
                            <label for="manage-select-beneficiary" class="block text-sm font-medium text-slate-700">Select Beneficiary</label>
                            <select id="manage-select-beneficiary" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm"></select>
                        </div>
                        <div id="manage-details-section" class="space-y-6 hidden">
                            <div>
                                <label for="manage-beneficiary-name" class="block text-sm font-medium text-slate-700">Beneficiary Name</label>
                                <input type="text" id="manage-beneficiary-name" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm">
                            </div>
                            <div>
                                <label for="manage-beneficiary-account" class="block text-sm font-medium text-slate-700">Account Number</label>
                                <input type="text" id="manage-beneficiary-account" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm">
                            </div>
                            <div>
                                <label for="manage-beneficiary-ifsc" class="block text-sm font-medium text-slate-700">IFSC Code</label>
                                <input type="text" id="manage-beneficiary-ifsc" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm">
                            </div>
                            <div class="flex justify-end space-x-4">
                                <button type="button" id="delete-beneficiary-btn" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700">Delete</button>
                                <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-equitas-purple hover:bg-opacity-90">Update Beneficiary</button>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- IMPS Transfer Form -->
                <div id="imps-transfer" class="tab-content hidden">
                    <form id="imps-form" class="space-y-6">
                        <h3 class="text-lg font-semibold text-slate-800">IMPS Transfer (24x7 Instant)</h3>
                        <div>
                            <label for="imps-beneficiary" class="block text-sm font-medium text-slate-700">Select Beneficiary</label>
                            <select id="imps-beneficiary" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm"></select>
                        </div>
                         <div>
                            <label for="imps-amount" class="block text-sm font-medium text-slate-700">Amount (₹)</label>
                            <input type="number" id="imps-amount" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm" placeholder="0.00">
                        </div>
                         <div>
                            <label for="imps-remarks" class="block text-sm font-medium text-slate-700">Remarks</label>
                            <input type="text" id="imps-remarks" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm" placeholder="Optional">
                        </div>
                        <div class="text-right">
                            <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-equitas-purple hover:bg-opacity-90">Proceed to Pay</button>
                        </div>
                    </form>
                </div>
                <!-- NEFT Transfer Form -->
                <div id="neft-transfer" class="tab-content hidden">
                     <form id="neft-form" class="space-y-6">
                        <h3 class="text-lg font-semibold text-slate-800">NEFT Transfer</h3>
                        <div>
                            <label for="neft-beneficiary" class="block text-sm font-medium text-slate-700">Select Beneficiary</label>
                            <select id="neft-beneficiary" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm"></select>
                        </div>
                         <div>
                            <label for="neft-amount" class="block text-sm font-medium text-slate-700">Amount (₹)</label>
                            <input type="number" id="neft-amount" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm" placeholder="0.00">
                        </div>
                         <div>
                            <label for="neft-remarks" class="block text-sm font-medium text-slate-700">Remarks</label>
                            <input type="text" id="neft-remarks" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-equitas-purple focus:ring-equitas-purple sm:text-sm" placeholder="Optional">
                        </div>
                        <div class="text-right">
                            <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-equitas-purple hover:bg-opacity-90">Proceed to Pay</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <div id="delete-modal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 text-center">
            <h3 class="text-lg font-semibold text-slate-900">Confirm Deletion</h3>
            <p class="text-slate-500 mt-2 mb-6">Are you sure you want to delete this beneficiary? This action cannot be undone.</p>
            <div class="flex justify-center space-x-4">
                <button id="cancel-delete" class="px-6 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition">Cancel</button>
                <button id="confirm-delete" class="px-6 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition">Delete</button>
            </div>
        </div>
    </div>
    
    <div id="confirm-transfer-modal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6">
            <div id="modal-content-wrapper">
                <h3 class="text-xl font-semibold text-slate-900 mb-4">Confirm Transaction</h3>
                <div class="space-y-3 border-y py-4">
                    <div class="flex justify-between"><span class="text-slate-500">To:</span> <span id="modal-beneficiary" class="font-medium text-slate-800"></span></div>
                    <div class="flex justify-between"><span class="text-slate-500">Amount:</span> <span id="modal-amount" class="font-bold text-equitas-purple text-lg"></span></div>
                    <div class="flex justify-between"><span class="text-slate-500">Remarks:</span> <span id="modal-remarks" class="font-medium text-slate-800 italic"></span></div>
                </div>
                <div class="mt-4">
                    <label for="transaction-password" class="block text-sm font-medium text-slate-700">Transaction Password</label>
                    <input type="password" id="transaction-password" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm" required>
                    <p id="password-error" class="mt-2 text-sm text-red-600 hidden"></p>
                </div>
                <div class="flex justify-end space-x-4 mt-6">
                    <button id="cancel-transfer" class="px-6 py-2 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition">Cancel</button>
                    <button id="confirm-transfer-btn" class="px-6 py-2 text-sm font-medium text-white bg-equitas-purple hover:bg-opacity-90 rounded-lg transition">Confirm</button>
                </div>
            </div>
            <div id="modal-loading-state" class="hidden text-center py-8">
                <div class="loader mx-auto" style="width: 40px; height: 40px; border-width: 4px;"></div>
                <p class="mt-4 text-slate-600 font-medium">Confirming Transaction...</p>
            </div>
        </div>
    </div>

    <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 text-center">
            <svg class="mx-auto h-16 w-16 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <h3 class="mt-4 text-2xl font-bold text-slate-900">Transfer Successful!</h3>
            <p class="mt-2 text-slate-600">
                <span id="success-amount" class="font-bold"></span> has been transferred to <span id="success-beneficiary" class="font-bold"></span>.
            </p>
            <p class="mt-1 text-sm text-slate-500">Transaction ID: <span id="success-txnid"></span></p>
            <p class="mt-1 text-xs text-slate-400">on <span id="success-datetime"></span></p>
            <div class="mt-6">
                <button id="done-btn" class="inline-flex justify-center py-2 px-8 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-equitas-purple hover:bg-opacity-90">Done</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let beneficiaries = [
                { id: 1, name: 'Shankar', account: '9150812456', ifsc: 'HDFC0000123', type: 'individual' },
                { id: 2, name: 'Priya Sharma', account: '00018450625852', ifsc: 'ICIC0000456', type: 'individual' },
                { id: 3, name: 'Arjun Reddy', account: '35008336520', ifsc: 'SBIN0000789', type: 'individual' },
                { id: 4, name: 'Ananya Gupta', account: '950082253926', ifsc: 'AXIS0000112', type: 'individual' },
                { id: 5, name: 'Star Enterprises', account: '1379102002345', ifsc: 'IDIB000S158', type: 'company' },
                { id: 6, name: 'TCS Solutions', account: '9003765246', ifsc: 'CITI0000002', type: 'company' },
                { id: 7, name: 'Future Retail Ltd', account: '009002254822115', ifsc: 'BARB0VJTAL', type: 'company' },
                { id: 8, name: 'RAVPREE SINGH', account: '60530885913', ifsc: 'MAHB0000063', type: 'individual' }
            ];

            const beneficiaryForm = document.getElementById('beneficiary-form');
            const successAlert = document.getElementById('success-alert');
            const manageSelect = document.getElementById('manage-select-beneficiary');
            const impsSelect = document.getElementById('imps-beneficiary');
            const neftSelect = document.getElementById('neft-beneficiary');
            const manageDetailsSection = document.getElementById('manage-details-section');
            const manageNameInput = document.getElementById('manage-beneficiary-name');
            const manageAccountInput = document.getElementById('manage-beneficiary-account');
            const manageIfscInput = document.getElementById('manage-beneficiary-ifsc');
            const deleteBtn = document.getElementById('delete-beneficiary-btn');
            const deleteModal = document.getElementById('delete-modal');
            const cancelDeleteBtn = document.getElementById('cancel-delete');
            const confirmDeleteBtn = document.getElementById('confirm-delete');
            
            const confirmTransferModal = document.getElementById('confirm-transfer-modal');
            const modalContentWrapper = document.getElementById('modal-content-wrapper');
            const modalLoadingState = document.getElementById('modal-loading-state');
            const successModal = document.getElementById('success-modal');
            let currentTransaction = {};

            function populateBeneficiaries() {
                const allSelects = [manageSelect, impsSelect, neftSelect];
                allSelects.forEach(select => {
                    select.innerHTML = '<option value="">-- Select a Payee --</option>';
                    beneficiaries.forEach(b => {
                        const option = document.createElement('option');
                        option.value = b.id;
                        option.textContent = `${b.name} (${b.account})`;
                        select.appendChild(option);
                    });
                });
            }
            populateBeneficiaries();

            beneficiaryForm.addEventListener('submit', function(event) {
                event.preventDefault();
                const name = document.getElementById('beneficiary-name').value;
                const account = document.getElementById('beneficiary-account').value;
                const ifsc = document.getElementById('beneficiary-ifsc').value;

                if (name && account && ifsc) {
                    const newBeneficiary = {
                        id: Date.now(),
                        name: name,
                        account: `XXXX${account.slice(-4)}`,
                        ifsc: ifsc,
                        type: 'individual'
                    };
                    beneficiaries.push(newBeneficiary);
                    populateBeneficiaries();
                    beneficiaryForm.reset();
                    ifscDetails.classList.add('hidden');
                    ifscInput.classList.remove('border-green-500', 'border-red-500');
                    
                    successAlert.classList.remove('hidden');
                    setTimeout(() => {
                        successAlert.classList.add('hidden');
                    }, 3000);
                } else {
                    alert('Please fill all the fields.');
                }
            });

            manageSelect.addEventListener('change', () => {
                const selectedId = parseInt(manageSelect.value);
                const beneficiary = beneficiaries.find(b => b.id === selectedId);
                if (beneficiary) {
                    manageNameInput.value = beneficiary.name;
                    manageAccountInput.value = beneficiary.account;
                    manageIfscInput.value = beneficiary.ifsc;
                    manageDetailsSection.classList.remove('hidden');
                } else {
                    manageDetailsSection.classList.add('hidden');
                }
            });
            
            deleteBtn.addEventListener('click', () => {
                deleteModal.classList.remove('hidden');
            });

            cancelDeleteBtn.addEventListener('click', () => {
                deleteModal.classList.add('hidden');
            });
            
            confirmDeleteBtn.addEventListener('click', () => {
                const selectedId = parseInt(manageSelect.value);
                beneficiaries = beneficiaries.filter(b => b.id !== selectedId);
                populateBeneficiaries();
                manageDetailsSection.classList.add('hidden');
                deleteModal.classList.add('hidden');
                alert('Beneficiary deleted successfully!');
            });
            
            document.getElementById('manage-beneficiary-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const selectedId = parseInt(manageSelect.value);
                const beneficiaryIndex = beneficiaries.findIndex(b => b.id === selectedId);
                if (beneficiaryIndex > -1) {
                    beneficiaries[beneficiaryIndex].name = manageNameInput.value;
                    beneficiaries[beneficiaryIndex].account = manageAccountInput.value;
                    beneficiaries[beneficiaryIndex].ifsc = manageIfscInput.value;
                    populateBeneficiaries();
                    alert('Beneficiary updated successfully!');
                }
            });

            function handleTransfer(event, selectId, amountId, remarksId) {
                event.preventDefault();
                const select = document.getElementById(selectId);
                const amount = document.getElementById(amountId).value;
                const remarks = document.getElementById(remarksId).value;
                const beneficiaryText = select.options[select.selectedIndex].text;

                if (!select.value || !amount) {
                    alert('Please select a beneficiary and enter an amount.');
                    return;
                }
                
                currentTransaction = {
                    beneficiary: beneficiaryText,
                    amount: parseFloat(amount).toFixed(2),
                    remarks: remarks
                };

                document.getElementById('modal-beneficiary').textContent = currentTransaction.beneficiary;
                document.getElementById('modal-amount').textContent = `₹${currentTransaction.amount}`;
                document.getElementById('modal-remarks').textContent = currentTransaction.remarks || 'N/A';
                confirmTransferModal.classList.remove('hidden');
            }

            document.getElementById('imps-form').addEventListener('submit', (e) => handleTransfer(e, 'imps-beneficiary', 'imps-amount', 'imps-remarks'));
            document.getElementById('neft-form').addEventListener('submit', (e) => handleTransfer(e, 'neft-beneficiary', 'neft-amount', 'neft-remarks'));
            
            const passwordInput = document.getElementById('transaction-password');
            const passwordError = document.getElementById('password-error');
            let attemptsLeft = 3;
            
            document.getElementById('confirm-transfer-btn').addEventListener('click', () => {
                if (passwordInput.value === 'admin123') {
                    modalContentWrapper.classList.add('hidden');
                    modalLoadingState.classList.remove('hidden');

                    setTimeout(() => {
                        confirmTransferModal.classList.add('hidden');
                        
                        document.getElementById('success-amount').textContent = `₹${currentTransaction.amount}`;
                        document.getElementById('success-beneficiary').textContent = currentTransaction.beneficiary;
                        document.getElementById('success-txnid').textContent = `EQ${Date.now()}`;
                        document.getElementById('success-datetime').textContent = new Date().toLocaleString('en-IN');

                        // Store the deducted amount for the dashboard
                        localStorage.setItem('transactionAmountToDeduct', currentTransaction.amount);

                        successModal.classList.remove('hidden');
                        
                        modalContentWrapper.classList.remove('hidden');
                        modalLoadingState.classList.add('hidden');
                        passwordInput.value = '';
                        passwordError.classList.add('hidden');
                        attemptsLeft = 3;
                    }, 5000);
                } else {
                    attemptsLeft--;
                    passwordInput.value = '';
                    if (attemptsLeft > 0) {
                        passwordError.textContent = `Wrong password. ${attemptsLeft} ${attemptsLeft === 1 ? 'attempt' : 'attempts'} left.`;
                        passwordError.classList.remove('hidden');
                    } else {
                        passwordError.textContent = 'Too many attempts. Transaction locked.';
                        passwordError.classList.remove('hidden');
                        passwordInput.disabled = true;
                        document.getElementById('confirm-transfer-btn').disabled = true;
                        document.getElementById('confirm-transfer-btn').classList.add('opacity-50', 'cursor-not-allowed');
                    }
                }
            });

            document.getElementById('cancel-transfer').addEventListener('click', () => {
                confirmTransferModal.classList.add('hidden');
                passwordInput.value = '';
                passwordError.classList.add('hidden');
                attemptsLeft = 3;
            });

            document.getElementById('done-btn').addEventListener('click', () => {
                successModal.classList.add('hidden');
                document.getElementById('imps-form').reset();
                document.getElementById('neft-form').reset();
            });


            const today = new Date();
            const weekdays = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
            document.getElementById('date-month').textContent = months[today.getMonth()];
            document.getElementById('date-day').textContent = today.getDate().toString().padStart(2, '0');
            document.getElementById('date-weekday').textContent = weekdays[today.getDay()];

            const tabs = document.querySelectorAll('.tab-button');
            const contents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(item => item.classList.remove('border-equitas-purple', 'text-equitas-purple'));
                    tab.classList.add('border-equitas-purple', 'text-equitas-purple');
                    const targetId = tab.dataset.target;
                    contents.forEach(content => content.id === targetId ? content.classList.remove('hidden') : content.classList.add('hidden'));
                });
            });

            const ifscInput = document.getElementById('beneficiary-ifsc');
            const ifscLoader = document.getElementById('ifsc-loader');
            const ifscError = document.getElementById('ifsc-error');
            const ifscDetails = document.getElementById('ifsc-details');
            let debounceTimer;

            ifscInput.addEventListener('input', () => {
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    validateIfsc(ifscInput.value);
                }, 500);
            });

            async function validateIfsc(ifsc) {
                ifsc = ifsc.toUpperCase();
                ifscInput.value = ifsc;
                ifscError.classList.add('hidden');
                ifscDetails.classList.add('hidden');
                ifscInput.classList.remove('border-red-500', 'border-green-500');

                if (ifsc.length !== 11) {
                    if (ifsc.length > 0) {
                        ifscError.classList.remove('hidden');
                        ifscInput.classList.add('border-red-500');
                    }
                    return;
                }

                ifscLoader.classList.remove('hidden');

                try {
                    const response = await fetch(`https://ifsc.razorpay.com/${ifsc}`);
                    if (response.ok) {
                        const data = await response.json();
                        ifscDetails.textContent = `${data.BANK}, ${data.BRANCH}`;
                        ifscDetails.classList.remove('hidden');
                        ifscInput.classList.add('border-green-500');
                    } else {
                        ifscError.classList.remove('hidden');
                        ifscInput.classList.add('border-red-500');
                    }
                } catch (error) {
                    console.error("Error validating IFSC:", error);
                    ifscError.textContent = "Could not validate IFSC. Please check connection.";
                    ifscError.classList.remove('hidden');
                    ifscInput.classList.add('border-red-500');
                } finally {
                    ifscLoader.classList.add('hidden');
                }
            }
        });
    </script>
</body>
</html>






